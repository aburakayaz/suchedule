const config={term:"202501",dataVersion:65};config.infoLink=`https://suis.sabanciuniv.edu/prod/bwckschd.p_disp_detail_sched?term_in=${config.term}&crn_in=`,Object.freeze(config);const templateGenerator=(()=>{const e=(()=>{const e=["Mon","Tue","Wed","Thu","Fri","TBA"];return t=>e[t]})();return{makeCourseEntry:(t,n,o)=>`\n        <div class="course-entry hide-info" data-code="${t.code}">\n            <div class="course-header">\n                <div class="course-name">${t.code} - ${t.name}</div>\n                <div class="course-expand icon-right-open-big"></div>\n            </div>\n            <div class="course-info">\n            ${t.classes.map(s=>`\n                <div class="course-sections">\n                    <div class="section-type">Sections${s.type?` (${s.type})`:""}</div>\n                ${s.sections.map(r=>`\n                    <div class="course-section" \n                        data-section-name="${t.code.replace(" ","")}${s.type} - ${r.group}"\n                        data-crn="${r.crn}">\n                    <div class="section-info">\n                        <div class="section-header">\n                            <div class="section-group" data-group="${r.group}">${r.group}</div>\n                            <a href="${config.infoLink}${r.crn}" class="section-link" target="_blank">info</a>\n                        </div>\n                        <div class="instructor">${n[r.instructors]}</div>\n                        <div class="section-days">\n                        ${r.schedule.map(t=>`\n                            <div class="section-day" \n                                data-day="${t.day}"\n                                data-start="${t.start}" \n                                data-duration="${t.duration}"\n                                data-place="${o[t.place]}">\n                                ${e(t.day)} ${((e,t)=>{if(-1===e)return"TBA";const n=(e+=8)+t;return`${e<10?"0":""}${e}:40-${n<10?"0":""}${n}:30`})(t.start,t.duration)} ${o[t.place]}\n                            </div>\n                        `).join("")}\n                        </div>\n                    </div>\n                    <div class="section-button"></div>\n                    </div>\n                `).join("")}\n                </div>\n            `).join("")}\n            </div>\n        </div>\n    `,makeCellCourse:(e,t,n="azure")=>`\n        <div class="cell-course" data-crn="${t}" data-section-name="${e}"\n            style="background-color: ${n};">\n            <div>${e}</div>\n            <div class="remove-course"></div>\n        </div>\n    `}})(),colorPalette=(()=>{let e=["#2096BA","#C5919D","#DF6E21","#874E4C","#32485C","#765285","#351C4D","#FF7E5F","#726A95","#849974","#36384C","#F26968","#F2AD9F","#6CBF84","#323339","#AB3E16","#EFAA52","#48120E","#B37C57","#9AACB8"];const t=e.slice(0);return{getColor:()=>e.splice(Math.floor(Math.random()*e.length),1).shift()||"azure",putColor:t=>"azure"===t?null:e.push(t),reset:()=>e=t.slice(0)}})(),saveSchedule=()=>{localStorage.setItem("saved-schedule",cellCourses.getAllCrnDataToSave().join(","))},courseEntry=(()=>{const e=function(t){return t instanceof $?new e.prototype.Init(t):e.findByCode(t)};return e.prototype.Init=function(e){return this.getElement=function(){return e.first()},this},e.prototype.Init.prototype=e.prototype,e.prototype.isOpen=function(){return!this.getElement().hasClass("hide-info")},e.prototype.open=function(){return this.getElement().removeClass("hide-info"),this.getElement().siblings(":not(hide-info)").addClass("hide-info"),this.updateSelectionsOnSchedule(),this},e.prototype.close=function(){return this.getElement().addClass("hide-info"),this.hideSelectionsOnSchedule(),this},e.prototype.toggleOpen=function(){return this.isOpen()?this.close():this.open(),this},e.prototype.getCodeWithSpace=function(){return this.getElement().data("code")},e.prototype.getCodeWithoutSpace=function(){return this.getElement().data("code").replace(/ /g,"")},e.prototype.getName=function(){return this.getElement().find(".course-name").text()},e.prototype.showSelectionsOnSchedule=function(){return this.getSections(".course-section.selected").forEach(e=>{e.getClassCells().getElements().addClass("selection")}),this},e.prototype.hideSelectionsOnSchedule=function(){return $(".class-cell").removeClass("selection"),this},e.prototype.updateSelectionsOnSchedule=function(){return this.hideSelectionsOnSchedule(),this.isOpen()&&!this.isSelectionComplete()&&this.showSelectionsOnSchedule(),this},e.prototype.addFilter=function(e){return this.getElement().addClass(`filter-hide-${e}`),this},e.prototype.removeFilter=function(e){return this.getElement().removeClass(`filter-hide-${e}`),this},e.prototype.nameContains=function(e){let t=this.getName();return t=t.replaceAll(/\s+/g,"").toUpperCase(),t.indexOf(e)>-1},e.prototype.isSelectionComplete=function(){return this.getElement().find(".selected").length===this.getElement().find(".course-sections").length},e.prototype.isMainCourseSelected=function(){return this.getElement().find(".course-sections:first .selected").length>0},e.prototype.getSections=function(e=".course-section"){return $.map(this.getElement().find(e),e=>sectionEntry($(e)))},e.prototype.getCellCourseColor=function(){return cellCourses.findByCourseCode(this.getCodeWithoutSpace()).getColor()},e.prototype.isOnSchedule=function(){return cellCourses.findByCourseCode(this.getCodeWithoutSpace()).getElements().length>0},e.prototype.addToSchedule=function(){this.hideSelectionsOnSchedule();const e=colorPalette.getColor();return this.getSections(".course-section.selected").forEach(t=>{t.getClassCells().addCellCourse(cellCourses.make(t.getName(),t.getCrn(),e))}),saveSchedule(),this},e.prototype.removeFromSchedule=function(){return this.isOnSchedule()&&(colorPalette.putColor(this.getCellCourseColor()),this.getSections().forEach(e=>{classCells.findContainsCrn(e.getCrn()).removeCellCourse(e.getCrn())})),this.updateSelectionsOnSchedule(),saveSchedule(),this},e.prototype.actOnSectionSelected=function(){return this.updateSelectionsOnSchedule(),this.isSelectionComplete()&&this.addToSchedule(),this},e.prototype.actOnSectionDeselected=function(){return this.removeFromSchedule(),this.isMainCourseSelected()&&!this.isOpen()&&(e.endDisplayMode(),e.startDisplayMode(this.getCodeWithSpace())),this},e.prototype.hasEmptySection=function(){for(const e of this.getElement().find(".course-sections"))if(0===$(e).find(".course-section:not([class*=filter-hide-])").length)return!0;return!1},e.closeAll=()=>{$(".course-entry").addClass("hide-info")},e.findByCode=t=>e($(`.course-entry[data-code="${t}"]`)),e.clearFilter=e=>{$(".course-entry").removeClass(`filter-hide-${e}`)},e.filter=(t,n)=>{$(".course-entry").each((o,s)=>{s=e($(s)),t(s)?s.removeFilter(n):s.addFilter(n)})},e.filterIfAnyEmptySection=()=>{e.filter(e=>!e.hasEmptySection(),"empty-section")},e.startDisplayMode=t=>{e(t).open().getElement().addClass("display-alone"),$("#menu").addClass("display-mode"),$("body").removeClass("hide-menu")},e.endDisplayMode=()=>{e($(".display-alone")).close().getElement().removeClass("display-alone"),$("#menu").removeClass("display-mode")},e.isOnDisplayMode=()=>$("#menu").hasClass("display-mode"),e.make=(t,n)=>e(templateGenerator.makeCourseEntry(t,n)),e.populate=(e,t,n)=>{const o=$("#course-list").removeClass("loading");e.forEach(e=>{o.append(templateGenerator.makeCourseEntry(e,t,n))})},e})(),sectionEntry=(()=>{const e=function(t){return t instanceof $?new e.prototype.Init(t):e.findByCrn(t)};return e.prototype.Init=function(e){return this.getElement=function(){return e},this},e.prototype.Init.prototype=e.prototype,e.prototype.getCrn=function(){return this.getElement().data("crn")},e.prototype.getName=function(){return this.getElement().data("section-name")},e.prototype.getInstructorName=function(){return this.getElement().find(".instructor").text()},e.prototype.instructorNameContains=function(e){return this.getInstructorName().toUpperCase().indexOf(e)>-1},e.prototype.getGeneralName=function(){return this.getName().split(" ",2).shift()},e.prototype.isSelected=function(){return this.getElement().hasClass("selected")},e.prototype.deselectAlternatives=function(){return this.getElement().siblings(".selected").each((t,n)=>e($(n)).deselect()),this},e.prototype.addFilter=function(e){return this.getElement().addClass(`filter-hide-${e}`),this},e.prototype.removeFilter=function(e){return this.getElement().removeClass(`filter-hide-${e}`),this},e.prototype.getCourseEntry=function(){return courseEntry(this.getElement().parents(".course-entry"))},e.prototype.getScheduleData=function(){return this.getElement().find(".section-day").map((e,t)=>({day:$(t).data("day"),start:$(t).data("start"),duration:$(t).data("duration")})).toArray()},e.prototype.getClassCells=function(){return classCells($($.map(this.getScheduleData(),e=>$("#schedule tr").slice(e.start+1,e.start+e.duration+1).find(`td:eq(${e.day+1})`).toArray())))},e.prototype.select=function(){return this.getElement().addClass("selected"),this.deselectAlternatives(),this.getCourseEntry().actOnSectionSelected(),this},e.prototype.deselect=function(e=!0){return this.getElement().removeClass("selected"),e&&this.getCourseEntry().actOnSectionDeselected(),this},e.prototype.toggleSelect=function(){return this.isSelected()?this.deselect():this.select(),this},e.findByCrn=t=>e($(`.course-section[data-crn="${t}"]:first`)),e.clearFilter=(e,t=!0)=>{$(".course-section").removeClass(`filter-hide-${e}`),t&&courseEntry.filterIfAnyEmptySection()},e.filter=(t,n,o=!0)=>{$(".course-section").each((o,s)=>{s=e($(s)),t(s)?s.removeFilter(n):s.addFilter(n)}),o&&courseEntry.filterIfAnyEmptySection()},e.filterByDays=()=>{let t=[];$("#day-filter-selections input").each((e,n)=>{$(n).is(":checked")&&t.push(e)}),t.push(5),e.filter(e=>{for(const n of e.getElement().find(".section-day"))if(-1===t.indexOf(Number($(n).data("day"))))return!1;return!0},"day")},e})(),cellCourses=(()=>{const e=function(t){return t instanceof $?new e.prototype.Init(t):e.findByCrn(t)};return e.prototype.Init=function(e){return this.getElements=function(){return e},this},e.prototype.Init.prototype=e.prototype,e.prototype.getSectionName=function(){return this.getElements().first().data("section-name")},e.prototype.getCourseCodeWithSpace=function(){return this.getSectionName().replace(/([A-Z]+)(\d+).*/,"$1 $2")},e.prototype.getCourseCodeWithoutSpace=function(){return this.getSectionName().replace(/([A-Z]+)(\d+).*/,"$1$2")},e.prototype.getParentClassCells=function(){return classCells(this.getElements().parent())},e.prototype.isOfMainCourse=function(){return/^[A-Z]+\d+ .*$/.test(this.getSectionName())},e.prototype.animateCloseButtons=function(t=!0){return t&&this.isOfMainCourse()&&e.findByCourseCode(this.getCourseCodeWithoutSpace()).animateCloseButtons(!1),this.getElements().addClass("animate"),this},e.prototype.getColor=function(){return this.getElements().first().css("background-color")},e.getAllCrnDataToCopy=()=>{const e={};let t=[];return $(".cell-course").each((n,o)=>{const s=$(o).data("crn");e.hasOwnProperty(s)||t.push(`${$(o).data("section-name")}: ${s}`),e[$(o).data("crn")]=1}),t.sort().join("\n")},e.getAllCrnDataToSave=()=>{const e={};return $(".cell-course").each((t,n)=>{e[$(n).data("crn")]=1}),Object.keys(e)},e.findByCrn=t=>e($(`.cell-course[data-crn="${t}"]`)),e.findByGeneralSectionName=t=>e($(`.cell-course[data-section-name^="${t}"]`)),e.findByCourseCode=t=>e($(`.cell-course[data-section-name^="${t}"]`)),e.make=(t,n,o)=>e($(templateGenerator.makeCellCourse(t,n,o))),e})(),classCells=(()=>{const e=function(t){return t instanceof $?new e.prototype.Init(t):e.findContainsCrn(t)};return e.prototype.Init=function(e){return this.getElements=function(){return e},this},e.prototype.Init.prototype=e.prototype,e.prototype.getElementsByChildrenCount=function(e){return $($.map(this.getElements(),t=>{if($(t).children().length===e)return t}))},e.prototype.addCellCourse=function(e){return this.getElements().addClass("filled").append(e.getElements().first().clone()),this.getElementsByChildrenCount(1).addClass("make-available"),this},e.prototype.removeCellCourse=function(e){return cellCourses.findByCrn(e).getElements().remove(),this.getElementsByChildrenCount(0).removeClass("filled"),this},e.clearInterests=()=>{$(".interested").removeClass("interested").removeClass("make-available")},e.findContainsCrn=t=>e($(".class-cell").has(`[data-crn="${t}"]`)),e})();(showFirstVisitNotifications=()=>{null===localStorage.getItem("visited-before")&&(localStorage.setItem("visited-before","yes"),$("#notify-about").show(),$("#notify-cookies").show())})(),(updateCourseData=()=>{const e=`course-data-${config.term}-${config.dataVersion}`,t=localStorage.getItem(e),n=()=>{let e=!1;for(let t=0;;t++){const n=localStorage.key(t);if(null===n)break;(n.indexOf("course-data")>-1||n.indexOf("saved-schedule")>-1)&&(localStorage.removeItem(n),e=!0)}e&&$("#notify-data-updated").fadeIn(500)};if(null!==t){const{courses:e,instructors:n,places:o}=JSON.parse(t);return void courseEntry.populate(e,n,o)}$.getJSON(`data-v${config.dataVersion}.min.json`,t=>{const{courses:o,instructors:s,places:r}=t;n(),courseEntry.populate(o,s,r),localStorage.setItem(e,JSON.stringify(t))})})();const normalizeSearchParam=e=>e=(e=e.trim().toUpperCase()).replaceAll(/\s+/g,"");(setEvents=()=>{$(document).on("click",".course-header",e=>{courseEntry($(e.currentTarget).parent()).toggleOpen(),courseEntry.isOnDisplayMode()&&courseEntry.endDisplayMode()}),$(document).on("click",".section-link",e=>{e.stopPropagation()}),$(document).on("click",".course-section",e=>{sectionEntry($(e.currentTarget)).toggleSelect()}),$(document).on("click",".remove-course",e=>{sectionEntry($(e.currentTarget).parent().data("crn")).toggleSelect(),e.stopPropagation()}),$(document).on("mouseenter",".remove-course,.course-section.selected",e=>{cellCourses($(e.currentTarget).closest("[data-crn]").data("crn")).animateCloseButtons()}),$(document).on("mouseleave",".remove-course,.course-section.selected",e=>{$(".cell-course.animate").removeClass("animate"),e.stopPropagation()}),$(document).on("click",".cell-course",e=>{courseEntry.startDisplayMode(cellCourses($(e.currentTarget)).getCourseCodeWithSpace())}),$(document).on("mouseenter",".course-section",e=>{const t=sectionEntry($(e.currentTarget));t.getClassCells().getElements().addClass("interested"),cellCourses.findByGeneralSectionName(t.getGeneralName()).getParentClassCells().getElements().filter(".interested").addClass("make-available")}),$(document).on("mouseleave",".course-section",()=>{classCells.clearInterests()});const e=e=>{courseEntry.closeAll();const t="search",n=normalizeSearchParam($("#search-box").val())||"";switch($("#search-category").val()){case"name":courseEntry.filter(e=>e.nameContains(n),t),sectionEntry.clearFilter(t);break;case"instructor":courseEntry.clearFilter(t),sectionEntry.filter(e=>e.instructorNameContains(n),t)}};$("#search-category").on("change",e),$("#search-box").on("input",e),$("#menu-toggle").on("click",()=>$("body").toggleClass("hide-menu")),$(document).on("keyup",e=>{27===e.keyCode&&(courseEntry.isOnDisplayMode()?courseEntry.endDisplayMode():$("#search-box").val("").trigger("input"))}),$(document).on("click","#clear-button",()=>$("#notify-clear").fadeIn(500)),$(document).on("click","#about-button",()=>$("#notify-about").fadeIn(500)),$(document).on("click","#about-button",()=>$("#notify-cookies").fadeIn(500))})(),(setWeekdayFilterEvents=()=>{$(document).on("input","#day-filter-selections input",e=>{sectionEntry.filterByDays()}),$("#day-filter-selections input:not(:checked)").length>0&&(sectionEntry.filterByDays(),$("#day-filter-selections").show())})(),(loadScheduleFromLocalStorage=()=>{const e=localStorage.getItem("saved-schedule");null!==e&&e.split(",").forEach(e=>{$(`.course-section[data-crn="${e}"]`).click()})})(),(setNotificationEvents=()=>{$(document).on("click",".notification .button",e=>{$(e.target).closest(".notification").fadeOut(500)}),$(document).on("click","#notify-clear .notification-button",()=>{$(".course-section.selected").removeClass("selected"),$(".class-cell").attr("class","class-cell").children().remove(),colorPalette.reset(),saveSchedule()})})(),(initializeClipboardJS=()=>{const e=new ClipboardJS("#copy-button",{text:()=>cellCourses.getAllCrnDataToCopy()});e.on("success",()=>{const e=$("#notify-copied");e.fadeIn(500),setTimeout(()=>{e.fadeOut(500)},2e3)}),e.on("error",e=>{const t=$("#notify-copy-fail");t.find(".notification-content p").text(e.text),t.fadeIn(500)})})();